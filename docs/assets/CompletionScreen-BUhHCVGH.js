import{j as e,aO as k,b4 as V,aN as w,b5 as H,P as s,B as A,I as U,aY as Y,aZ as L,e as S,m as j,C as Z,n as G,r as J,g as C,aL as K,b6 as Q,b7 as X}from"./mui-DHtKCVyI.js";import{r as n}from"./vendor-B0qVADJY.js";import{f as _,d as R}from"./helpers-CCWTPML7.js";import{u as ee,m as h,h as se,i as oe,s as re}from"./index-Bme_WGpp.js";import{getPersonalRecords as ie,detectNewPRs as te}from"./trackingMetrics-i_WWAY_P.js";import"./firebase-CJLtoEJQ.js";const N=({open:i,onClose:a,prData:g})=>{if(!g)return null;const y=()=>{const{exerciseName:l,type:u,value:p,previousValue:d}=g;return u==="weight"?`New ${l} PR! ðŸŽ‰ ${p} lbs (previous: ${d} lbs)`:u==="reps"?`New ${l} Rep PR! ðŸŽ‰ ${p} reps (previous: ${d} reps)`:u==="oneRepMax"?`New ${l} 1RM! ðŸŽ‰ ${p} lbs (previous: ${d} lbs)`:`New ${l} PR! ðŸŽ‰`};return e.jsx(k,{open:i,autoHideDuration:4e3,onClose:a,anchorOrigin:{vertical:"top",horizontal:"center"},TransitionComponent:V,children:e.jsx(w,{onClose:a,severity:"success",variant:"filled",sx:{width:"100%",fontSize:"1rem","& .MuiAlert-icon":{fontSize:"2rem"}},icon:e.jsx(H,{}),children:y()})})};N.propTypes={open:s.bool.isRequired,onClose:s.func.isRequired,prData:s.shape({exerciseName:s.string.isRequired,type:s.string.isRequired,value:s.number.isRequired,previousValue:s.number})};s.bool.isRequired,s.func.isRequired,s.shape({days:s.number.isRequired,badge:s.string.isRequired,description:s.string.isRequired});s.bool.isRequired,s.func.isRequired,s.shape({workoutsCompleted:s.number,totalVolume:s.number,totalTime:s.number,prsAchieved:s.number,topExercises:s.arrayOf(s.shape({name:s.string,count:s.number})),adherence:s.number});s.array,s.array,s.object,s.func,s.func,s.func;const $=n.memo(({workoutData:i,workoutPlan:a,onFinish:g,onExportCSV:y})=>{const[l,u]=n.useState(!1),[p,d]=n.useState(!1),[x,q]=n.useState([]),[W,z]=n.useState(0),[D,T]=n.useState(!1),[E,m]=n.useState(!1),[I,f]=n.useState(""),{isAutoAssignWeek:b,assignWorkoutToDay:v,weeklySchedule:O}=ee();n.useEffect(()=>{(async()=>{try{const t=await oe(),r=ie(t.slice(1)),c=te(i,r);c.length>0&&q(c)}catch(t){console.error("Error checking for PRs:",t)}})()},[i]),n.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]),n.useEffect(()=>{(async()=>{if(b()&&i&&a)try{const t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][new Date().getDay()],r=R(i),c={sessionType:r,sessionName:`${r.charAt(0).toUpperCase()+r.slice(1)} Body Workout`,exercises:a,date:new Date().toISOString()};await v(t,c),f(`Automatically assigned to ${t}`),m(!0)}catch(t){console.error("Error auto-assigning workout:",t)}})()},[b,i,a,v]);const P=()=>{try{if(!a||a.length===0){alert("Cannot save workout: No exercise data available");return}const o=R(i);re({name:`${o.charAt(0).toUpperCase()+o.slice(1)} Body Workout`,type:o,equipment:"all",exercises:a}),u(!0),d(!0)}catch(o){console.error("Error saving to favorites:",o),alert("Failed to save workout to favorites")}},F=()=>{T(!0)},B=async(o,t)=>{try{const r=R(i),c={sessionType:r,sessionName:`${r.charAt(0).toUpperCase()+r.slice(1)} Body Workout`,exercises:a,date:new Date().toISOString()};await v(o,c),f(`Workout assigned to ${o}`),m(!0)}catch(r){console.error("Error assigning workout:",r),f("Failed to assign workout"),m(!0)}};return e.jsxs(h.div,{className:"screen completion-screen",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},style:{padding:"1rem",maxWidth:"900px",margin:"0 auto"},children:[e.jsxs(h.div,{className:"completion-header",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2,type:"spring",stiffness:200},children:[e.jsx(A,{sx:{position:"relative"},children:e.jsx(U,{onClick:P,disabled:l,sx:{position:"absolute",top:0,right:0,color:l?"warning.main":"white","&:hover":{color:"warning.main"}},"aria-label":"Save to favorites",children:l?e.jsx(Y,{sx:{fontSize:32}}):e.jsx(L,{sx:{fontSize:32}})})}),e.jsx(h.div,{initial:{y:-20},animate:{y:[0,-10,0]},transition:{repeat:1/0,duration:2,ease:"easeInOut"},children:e.jsx("img",{src:"/goodlift/dancing-icon.svg",alt:"Celebration",style:{width:"120px",height:"120px",marginBottom:"1rem"}})}),e.jsx("h1",{children:"Workout Complete!"}),e.jsxs("p",{className:"completion-time",children:["Total Time: ",e.jsx("strong",{children:_(i.duration)})]})]}),e.jsxs("div",{className:"workout-summary-container",children:[e.jsx(S,{variant:"h4",component:"h2",sx:{fontWeight:700,mb:3,textAlign:"center",color:"text.primary"},children:"Workout Summary"}),e.jsx(j,{spacing:2,children:Object.entries(i.exercises).map(([o,t],r)=>e.jsx(h.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3+r*.1},children:e.jsx(Z,{sx:{borderRadius:3,transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 24px rgba(48, 86, 105, 0.15)"}},children:e.jsxs(G,{children:[e.jsx(S,{variant:"h6",component:"h3",sx:{color:"primary.main",fontWeight:600,mb:2,pb:1,borderBottom:"2px solid",borderColor:"rgba(138, 190, 185, 0.2)"},children:o}),e.jsx(j,{spacing:1,children:t.sets.map((c,M)=>e.jsxs(A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:1.5,bgcolor:"rgba(183, 229, 205, 0.3)",borderRadius:2,transition:"all 0.2s ease","&:hover":{bgcolor:"primary.main",color:"white","& .MuiChip-root":{bgcolor:"white",color:"primary.main"}}},children:[e.jsx(J,{label:`Set ${c.set}`,size:"small",sx:{fontWeight:600,minWidth:60}}),e.jsxs(S,{sx:{fontWeight:600,fontSize:"1rem"},children:[c.weight," lbs Ã— ",c.reps," reps"]})]},M))})]})})},o))})]}),e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:e.jsxs(j,{direction:{xs:"column",sm:"row"},spacing:2,sx:{mt:4},children:[!b()&&e.jsx(C,{variant:"outlined",size:"large",startIcon:e.jsx(K,{}),onClick:F,sx:{flex:1,borderRadius:2,py:1.5,fontSize:"1rem",fontWeight:600,borderColor:"info.main",color:"info.main","&:hover":{borderColor:"info.dark",bgcolor:"rgba(33, 150, 243, 0.1)"}},children:"Assign to Day"}),e.jsx(C,{variant:"outlined",size:"large",startIcon:e.jsx(Q,{}),onClick:y,sx:{flex:1,borderRadius:2,py:1.5,fontSize:"1rem",fontWeight:600,borderColor:"secondary.main",color:"secondary.main","&:hover":{borderColor:"secondary.dark",bgcolor:"rgba(193, 120, 90, 0.1)"}},children:"Download CSV"}),e.jsx(C,{variant:"contained",size:"large",startIcon:e.jsx(X,{}),onClick:g,sx:{flex:1,borderRadius:2,py:1.5,fontSize:"1rem",fontWeight:600,bgcolor:"primary.main","&:hover":{bgcolor:"primary.dark"}},children:"Finish"})]})}),e.jsx(k,{open:p,autoHideDuration:3e3,onClose:()=>d(!1),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(w,{severity:"success",onClose:()=>d(!1),children:"Workout saved to favorites!"})}),e.jsx(k,{open:E,autoHideDuration:3e3,onClose:()=>m(!1),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(w,{severity:"success",onClose:()=>m(!1),children:I})}),e.jsx(se,{open:D,onClose:()=>T(!1),onAssign:B,workoutData:i,currentSchedule:O}),x.length>0&&W<x.length&&e.jsx(N,{open:!0,onClose:()=>z(o=>o+1),prData:x[W]})]})});$.displayName="CompletionScreen";$.propTypes={workoutData:s.object.isRequired,workoutPlan:s.array,onFinish:s.func.isRequired,onExportCSV:s.func.isRequired};export{$ as default};
