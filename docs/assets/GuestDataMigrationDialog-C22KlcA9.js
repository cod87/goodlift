import{j as e,D as m,c as b,B as j,bZ as g,e as o,d as v,f as D,g as x,bE as _,P as c}from"./mui-DHtKCVyI.js";import{r as d}from"./vendor-B0qVADJY.js";import{a7 as h,a8 as k,a9 as w,aa as T,ab as E,ac as S}from"./index-Bme_WGpp.js";import"./firebase-CJLtoEJQ.js";const P=({open:p,onClose:i,userId:a})=>{const[t,n]=d.useState(!1),[u,l]=d.useState(null),y=async()=>{if(!a){l("No user ID provided");return}n(!0),l(null);try{const s=k(),r=[];s.workout_history&&s.workout_history.length>0&&r.push(w(a,s.workout_history)),s.user_stats&&r.push(T(a,s.user_stats)),s.exercise_weights&&Object.keys(s.exercise_weights).length>0&&r.push(E(a,s.exercise_weights)),s.exercise_target_reps&&Object.keys(s.exercise_target_reps).length>0&&r.push(S(a,s.exercise_target_reps)),await Promise.all(r),h(),n(!1),i(!0)}catch(s){console.error("Error migrating guest data:",s),l("Failed to migrate data. Please try again."),n(!1)}},f=()=>{h(),i(!1)};return e.jsxs(m,{open:p,onClose:t?void 0:()=>i(!1),maxWidth:"sm",fullWidth:!0,disableEscapeKeyDown:t,PaperProps:{sx:{borderRadius:2}},children:[e.jsx(b,{sx:{pb:1},children:e.jsxs(j,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(g,{sx:{color:"primary.main",fontSize:28}}),e.jsx(o,{variant:"h6",component:"span",sx:{fontWeight:600},children:"Save Your Guest Data?"})]})}),e.jsxs(v,{children:[e.jsx(o,{variant:"body1",sx:{mb:2},children:"You have workout data from your guest session. Would you like to transfer it to your new account?"}),e.jsx(o,{variant:"body2",sx:{color:"text.secondary"},children:"This will save your workout history, progress, and settings to the cloud."}),u&&e.jsx(o,{variant:"body2",sx:{color:"error.main",mt:2},children:u})]}),e.jsxs(D,{sx:{p:2,pt:0},children:[e.jsx(x,{onClick:f,disabled:t,variant:"text",sx:{color:"text.secondary"},children:"Skip"}),e.jsx(x,{onClick:y,disabled:t,variant:"contained",startIcon:t?e.jsx(_,{size:20,color:"inherit"}):e.jsx(g,{}),sx:{fontWeight:600},children:t?"Migrating...":"Save My Data"})]})]})};P.propTypes={open:c.bool.isRequired,onClose:c.func.isRequired,userId:c.string};export{P as default};
