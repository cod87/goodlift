import{j as e,B as x,e as g,I as C,aZ as J,b3 as K,a5 as he,A as ue,m as z,C as fe,n as be,r as R,z as Q,b4 as ye,g as q,X as Se,aO as ee,aN as te,P as c}from"./mui-D40dqk12.js";import{r as o}from"./vendor-B0qVADJY.js";import{g as H,b as D,m as j,E as je,s as ve,e as we,d as Ee}from"./index-BDi-38df.js";import{E as We}from"./ExerciseAutocomplete-oQM0oc6-.js";import"./firebase-CJLtoEJQ.js";const se=o.memo(({workout:h,workoutType:k,onStart:re,onCancel:ae,onRandomizeExercise:v,isCustomizeMode:u=!1,supersetConfig:I=[2,2,2,2],setsPerSuperset:ie=3})=>{const[b,m]=o.useState({}),[T,L]=o.useState(!0),[P,A]=o.useState(!1),[p,ne]=o.useState(!1),[oe,B]=o.useState(!1),[F,X]=o.useState({}),[y,w]=o.useState({open:!1,message:"",severity:"info"}),[M,V]=o.useState([]),[f,N]=o.useState(h),[S,Y]=o.useState(ie),[_,U]=o.useState(null),Z=f.some(s=>s!==null&&typeof s.sets=="number");o.useEffect(()=>{(async()=>{try{const r=await(await fetch(je)).json();V(r)}catch(t){console.error("Error loading exercises:",t),V([])}})()},[]),o.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"}),(async()=>{const t={};if(u){N(h),m({}),L(!1);return}const r=h.filter(a=>a!==null);for(const a of r){const i=a["Exercise Name"],[d,l]=await Promise.all([H(i),D(i)]);t[i]={weight:d??"",targetReps:l??""}}m(t),N(h),L(!1)})()},[h,u,I]),o.useEffect(()=>{const s=async()=>{const t=Object.keys(b),a=h.filter(i=>i!==null).filter(i=>!t.includes(i["Exercise Name"]));if(a.length>0){const i={...b};for(const d of a){const l=d["Exercise Name"];if(!F[l]){const[O,n]=await Promise.all([H(l),D(l)]);i[l]={weight:O??"",targetReps:n??""}}}m(i)}};!T&&Object.keys(b).length>0&&s()},[h,T]);const le=(s,t)=>{if(t===""||/^\d*\.?\d*$/.test(t)){const r=t===""?"":parseFloat(t);m(a=>({...a,[s]:{...a[s],weight:r}})),X(a=>({...a,[s]:{...a[s],weightCustomized:!0}}))}},ce=(s,t)=>{if(t===""||t===null||t===void 0)return;const r=parseFloat(t);if(!isNaN(r)&&r>0){const a=Math.round(r/2.5)*2.5;a!==r&&(m(i=>({...i,[s]:{...i[s],weight:a}})),w({open:!0,message:`Weight adjusted to ${a} lbs (nearest 2.5 lb increment)`,severity:"info"}))}},xe=(s,t)=>{if(t===""||/^\d+$/.test(t)){const r=t===""?"":parseInt(t,10);m(a=>({...a,[s]:{...a[s],targetReps:r}})),X(a=>({...a,[s]:{...a[s],repsCustomized:!0}}))}},de=(s,t)=>{if(t===""||t===null||t===void 0)return;const r=parseInt(t,10);(isNaN(r)||r<1)&&m(a=>({...a,[s]:{...a[s],targetReps:""}}))},me=o.useCallback((s,t)=>{v&&v(s,t)},[v]),pe=o.useCallback((s,t)=>{if(!t)return;N(a=>{const i=[...a];return i[s]=t,i});const r=t["Exercise Name"];F[r]||H(r).then(a=>{D(r).then(i=>{m(d=>({...d,[r]:{weight:a??"",targetReps:i??""}}))})})},[F]),ge=async()=>{if(!P){A(!0);try{if(u&&f.some(t=>t===null)){w({open:!0,message:"Please select exercises for all slots before starting",severity:"warning"}),A(!1);return}for(const[s,t]of Object.entries(b)){const r=t.weight===""?null:t.weight,a=t.targetReps===""?null:t.targetReps;await we(s,r),await Ee(s,a)}re(f,I,S)}catch(s){console.error("Error starting workout:",s),A(!1)}}},G=()=>{try{const s=f.filter(t=>t!==null);ve({name:`${k.charAt(0).toUpperCase()+k.slice(1)} Body Workout`,type:k,exercises:s}),ne(!0),B(!0)}catch(s){console.error("Error saving to favorites:",s)}},E=[];let $=0;for(const s of I){const t=[];for(let r=0;r<s&&$<f.length;r++)t.push(f[$]),$++;t.length>0&&E.push(t)}return T?e.jsx(x,{sx:{textAlign:"center",py:8,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:e.jsx(j.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:e.jsxs(g,{variant:"h5",sx:{color:"text.secondary",fontWeight:500},children:["Loading",e.jsx(j.span,{initial:{opacity:0},animate:{opacity:[0,1,0]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},children:"..."})]})})}):e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.4},className:"screen",style:{maxWidth:"900px",margin:"0 auto",padding:"1rem",width:"100%",boxSizing:"border-box",overflowX:"hidden"},children:[e.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",py:1,px:2,borderBottom:"1px solid",borderColor:"divider",mb:2},children:[e.jsxs(x,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsx(g,{variant:"h6",sx:{fontSize:"1.1rem",fontWeight:700},children:u?"Customize Workout":"Workout Preview"}),e.jsxs(g,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.875rem"},children:[E.length," Supersets • ",f.filter(s=>s!==null).length," Exercises",!Z&&` • ${S} Sets Each`]})]}),e.jsx(C,{onClick:G,disabled:p,size:"small",sx:{color:p?"warning.main":"action.active","&:hover":{color:"warning.main"}},"aria-label":"Save to favorites",children:p?e.jsx(J,{}):e.jsx(K,{})})]}),e.jsxs(x,{sx:{mb:{xs:2,sm:3},px:{xs:.5,sm:0}},children:[!Z&&e.jsxs(x,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:1,mb:1},children:[e.jsx(g,{variant:"body2",color:"text.secondary",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"}},children:"Sets per superset:"}),e.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(C,{size:"small",onClick:()=>Y(s=>Math.max(1,s-1)),disabled:S<=1,sx:{minWidth:"32px",minHeight:"32px",bgcolor:"action.hover","&:hover":{bgcolor:"action.selected"}},children:e.jsx(he,{fontSize:"small"})}),e.jsx(g,{variant:"h6",sx:{fontWeight:700,color:"primary.main",minWidth:"32px",textAlign:"center",fontSize:{xs:"1rem",sm:"1.25rem"}},children:S}),e.jsx(C,{size:"small",onClick:()=>Y(s=>Math.min(10,s+1)),disabled:S>=10,sx:{minWidth:"32px",minHeight:"32px",bgcolor:"action.hover","&:hover":{bgcolor:"action.selected"}},children:e.jsx(ue,{fontSize:"small"})})]})]}),e.jsx(g,{variant:"body2",color:"primary.main",sx:{fontWeight:600,fontSize:{xs:"0.75rem",sm:"0.875rem"}},children:u?"Select exercises and set your target weight and reps for each":"Set your starting target weight and target reps for each exercise"})]}),e.jsx(z,{spacing:{xs:2,sm:3},sx:{px:{xs:.5,sm:0}},children:E.map((s,t)=>e.jsx(j.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*t,duration:.4},children:e.jsx(fe,{sx:{background:"linear-gradient(135deg, rgba(138, 190, 185, 0.1), rgba(193, 120, 90, 0.1))",border:"2px solid",borderColor:"primary.main",borderRadius:3,transition:"all 0.3s ease",maxWidth:"100%",boxSizing:"border-box","&:hover":{transform:"translateY(-4px)",boxShadow:"0 12px 24px rgba(48, 86, 105, 0.2)"}},children:e.jsxs(be,{sx:{p:{xs:1.5,sm:2},"&:last-child":{pb:{xs:1.5,sm:2}}},children:[e.jsx(g,{variant:"h6",gutterBottom:!0,sx:{color:"secondary.main",fontWeight:600,mb:1.5,display:"flex",alignItems:"center",gap:1},children:e.jsx(R,{label:`Superset ${t+1}`,size:"small",sx:{bgcolor:"secondary.main",color:"white",fontWeight:600}})}),e.jsx(z,{spacing:{xs:1,sm:1.5},children:s.map((r,a)=>{const i=r?r["Exercise Name"]:null,d=i?b[i]||{weight:"",targetReps:""}:{weight:"",targetReps:""},l=E.slice(0,t).reduce((n,W)=>n+W.length,0)+a,O=String.fromCharCode(65+a);return e.jsxs(x,{sx:{position:"relative",p:{xs:1,sm:1.5},bgcolor:"background.paper",borderRadius:2,transition:"all 0.3s ease",transform:_===l?"translateX(8px)":"translateX(0)","&::before":{content:'""',position:"absolute",left:0,top:0,bottom:0,width:"4px",borderRadius:"2px 0 0 2px",bgcolor:_===l?"primary.main":"transparent",transition:"all 0.3s ease"}},onFocus:()=>U(l),onBlur:()=>U(null),children:[e.jsxs(x,{sx:{display:"flex",alignItems:"flex-start",gap:{xs:1,sm:1.5},mb:{xs:1,sm:1.5}},children:[e.jsx(g,{sx:{fontSize:{xs:"1.25rem",sm:"1.75rem"},color:"primary.main",fontWeight:700,width:{xs:"28px",sm:"36px"},textAlign:"center",flexShrink:0},children:O}),e.jsx(x,{sx:{flex:1,minWidth:0},children:e.jsx(x,{sx:{mb:.5},children:e.jsx(We,{value:r,onChange:(n,W)=>{W&&pe(l,W)},availableExercises:M,label:"Exercise",placeholder:u?"Type to search and select...":"Type to search and swap...",disabled:M.length===0})})})]}),r&&e.jsxs(e.Fragment,{children:[e.jsxs(z,{direction:"row",spacing:{xs:1,sm:1.5},sx:{pl:{xs:3.5,sm:5.5},flexWrap:{xs:"wrap",sm:"nowrap"},mb:{xs:1,sm:1.5}},children:[e.jsx(Q,{type:"tel",inputMode:"decimal",value:d.weight===""?"":d.weight,onChange:n=>le(i,n.target.value),onBlur:n=>ce(i,n.target.value),onFocus:n=>n.target.select(),placeholder:r.Equipment?.toLowerCase()==="bodyweight"?"N/A":"Weight (lbs)",size:"small",disabled:r.Equipment?.toLowerCase()==="bodyweight",inputProps:{min:0,max:500,step:2.5,pattern:"[0-9]*([.,][0-9]+)?","aria-label":`Target weight in pounds for ${i}`},sx:{minWidth:{xs:100,sm:120},flex:{xs:"1 1 45%",sm:"none"},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:"rgba(0, 0, 0, 0.38)",backgroundColor:"rgba(0, 0, 0, 0.04)"}}}),e.jsx(Q,{type:"tel",inputMode:"numeric",value:d.targetReps===""?"":d.targetReps,onChange:n=>xe(i,n.target.value),onBlur:n=>de(i,n.target.value),onFocus:n=>n.target.select(),placeholder:"Reps",size:"small",inputProps:{min:1,max:20,step:1,pattern:"\\d*","aria-label":`Target repetitions for ${i}`},sx:{minWidth:{xs:100,sm:120},flex:{xs:"1 1 45%",sm:"none"}}})]}),e.jsxs(x,{sx:{pl:{xs:3.5,sm:5.5},display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(R,{label:r["Primary Muscle"],size:"small",variant:"outlined",sx:{borderColor:"primary.main",color:"primary.main",fontSize:{xs:"0.65rem",sm:"0.75rem"}}}),e.jsx(R,{label:r.Equipment,size:"small",variant:"outlined",sx:{borderColor:"text.secondary",color:"text.secondary",fontSize:{xs:"0.65rem",sm:"0.75rem"}}}),typeof r.sets=="number"&&e.jsx(R,{label:`${r.sets} Set${r.sets!==1?"s":""}`,size:"small",variant:"filled",sx:{bgcolor:"primary.main",color:"white",fontSize:{xs:"0.65rem",sm:"0.75rem"}}}),v&&!u&&e.jsx(C,{size:"small",onClick:n=>{n.stopPropagation(),me(r,l)},sx:{color:"primary.main",minWidth:"36px",minHeight:"36px","&:hover":{backgroundColor:"rgba(19, 70, 134, 0.08)"}},"aria-label":`Randomize ${i}`,children:e.jsx(ye,{fontSize:"small"})})]})]})]},a)})})]})})},t))}),e.jsx(j.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:e.jsxs(z,{direction:"row",spacing:2,sx:{mt:{xs:3,sm:4},px:{xs:.5,sm:0}},justifyContent:"center",children:[e.jsx(q,{variant:"contained",size:"large",onClick:ae,sx:{borderRadius:2,minWidth:{xs:"60px",sm:"80px"},px:{xs:1,sm:2},py:1.5,fontSize:{xs:"1.2rem",sm:"1.5rem"},fontWeight:600,bgcolor:"rgb(237, 63, 39)",color:"white","&:hover":{bgcolor:"rgb(200, 50, 30)"}},children:"✕"}),e.jsx(q,{variant:"contained",size:"large",startIcon:p?e.jsx(J,{}):e.jsx(K,{}),onClick:G,disabled:p,sx:{borderRadius:2,flex:1,maxWidth:{xs:"130px",sm:"150px"},px:{xs:2,sm:3},py:1.5,fontSize:{xs:"0.9rem",sm:"1.1rem"},fontWeight:600,bgcolor:p?"rgb(76, 175, 80)":"rgb(254, 178, 26)",color:"white","&:hover":{bgcolor:p?"rgb(56, 142, 60)":"rgb(245, 158, 11)"},"&:disabled":{bgcolor:"rgb(76, 175, 80)",color:"white",opacity:.8}},children:p?"Saved!":"Save"}),e.jsx(q,{variant:"contained",size:"large",startIcon:e.jsx(Se,{}),onClick:ge,disabled:P,sx:{borderRadius:2,flex:1,maxWidth:{xs:"130px",sm:"150px"},px:{xs:2,sm:3},py:1.5,fontSize:{xs:"0.9rem",sm:"1.1rem"},fontWeight:600,bgcolor:"rgb(19, 70, 134)",color:"white","&:hover":{bgcolor:"rgb(15, 56, 107)",transform:"translateY(-2px)",boxShadow:"0 8px 16px rgba(19, 70, 134, 0.3)"},"&:disabled":{bgcolor:"rgb(19, 70, 134)",color:"white",opacity:.6},transition:"all 0.3s ease"},children:P?"Starting...":"Begin"})]})}),e.jsx(ee,{open:oe,autoHideDuration:3e3,onClose:()=>B(!1),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(te,{severity:"success",onClose:()=>B(!1),children:"Workout saved to favorites!"})}),e.jsx(ee,{open:y.open,autoHideDuration:4e3,onClose:()=>w({...y,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(te,{severity:y.severity,onClose:()=>w({...y,open:!1}),children:y.message})})]})});se.displayName="WorkoutPreview";se.propTypes={workout:c.array.isRequired,workoutType:c.string.isRequired,onStart:c.func.isRequired,onCancel:c.func.isRequired,onRandomizeExercise:c.func,equipmentFilter:c.oneOfType([c.string,c.array]),isCustomizeMode:c.bool,supersetConfig:c.arrayOf(c.number),setsPerSuperset:c.number};export{se as default};
