const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.esm-DhJjoBzz.js","assets/firebase-CJLtoEJQ.js"])))=>i.map(i=>d[i]);
import{a4 as t,a5 as a}from"./index-BDi-38df.js";const n="BE0ZQSJHIlmXfeA5ddjITNrqrS0TmGfGGQjBufmOlUKxRUtEwja2qHmTZ0pXHepJzGV2qcwH0gJ_D6ot6cWGB6w",m=async()=>{try{if(console.log("[Notification Permission] Requesting notification permission..."),!("Notification"in window))return console.error("[Notification Permission] âŒ Notification API not supported in this browser"),console.error("[Notification Permission] User agent:",navigator.userAgent),!1;const o=Notification.permission;if(console.log("[Notification Permission] Current permission state:",o),o==="granted")return console.log("[Notification Permission] âœ… Permission already granted"),!0;if(o==="denied")return console.error("[Notification Permission] âŒ Permission previously denied by user"),console.error("[Notification Permission] User must manually enable notifications in browser settings"),!1;await t()||(console.warn("[Notification Permission] âš ï¸  Firebase Messaging not supported in this browser"),console.warn("[Notification Permission] Will still request permission for native notifications")),console.log("[Notification Permission] Requesting permission from user...");const e=await Notification.requestPermission();return console.log("[Notification Permission] User response:",e),e==="granted"?(console.log("[Notification Permission] âœ… Permission granted by user"),!0):e==="denied"?(console.warn("[Notification Permission] âŒ Permission denied by user"),!1):(console.warn("[Notification Permission] âš ï¸  Permission dismissed by user (default state)"),!1)}catch(o){return console.error("[Notification Permission] âŒ Error requesting notification permission"),console.error("[Notification Permission] Error name:",o.name),console.error("[Notification Permission] Error message:",o.message),o.name==="NotAllowedError"&&(console.error("[Notification Permission] Permission request blocked by browser"),console.error("[Notification Permission] May need to be triggered by user interaction")),!1}},d=async()=>{try{console.log("[FCM] Starting FCM token retrieval...");const o=await t();if(!o)return console.warn("[FCM] âš ï¸  Firebase Messaging not available in this browser"),console.warn("[FCM] This is expected on Safari/iOS which does not support FCM"),console.warn("[FCM] Browser:",navigator.userAgent),null;console.log("[FCM] Firebase Messaging instance available");const i=Notification.permission;if(console.log("[FCM] Current notification permission:",i),i==="denied")return console.error("[FCM] âŒ Notification permission denied - cannot get FCM token"),null;if(i!=="granted"){console.log("[FCM] Requesting notification permission...");const r=await Notification.requestPermission();if(console.log("[FCM] Permission request result:",r),r!=="granted")return console.warn("[FCM] âš ï¸  Notification permission not granted"),null}console.log("[FCM] Requesting FCM token with VAPID key..."),console.log("[FCM] VAPID key (first 20 chars):",n.substring(0,20)+"...");const{getToken:e}=await a(async()=>{const{getToken:r}=await import("./index.esm-DhJjoBzz.js");return{getToken:r}},__vite__mapDeps([0,1])),s=await e(o,{vapidKey:n});return s?(console.log("[FCM] âœ… FCM token obtained successfully"),console.log("[FCM] ðŸ“‹ FCM Token (first 30 chars):",s.substring(0,30)+"..."),console.log("[FCM] Full token length:",s.length,"characters"),console.log("[FCM] ðŸ“¤ Send this token to your backend to enable Firebase push notifications"),console.log("[FCM] Token should be stored in your database associated with this user/device"),s):(console.warn("[FCM] âš ï¸  No FCM token received from Firebase"),console.warn("[FCM] This may indicate:"),console.warn("[FCM]   - Service worker not properly registered"),console.warn("[FCM]   - VAPID key mismatch with Firebase console configuration"),console.warn("[FCM]   - Firebase project configuration issue"),null)}catch(o){return console.error("[FCM] âŒ Error getting FCM token"),console.error("[FCM] Error name:",o.name),console.error("[FCM] Error message:",o.message),console.error("[FCM] Error code:",o.code),o.code==="messaging/permission-blocked"?(console.error("[FCM] Permission blocked by user - cannot retrieve token"),console.error("[FCM] User must enable notifications in browser settings")):o.code==="messaging/unsupported-browser"?(console.error("[FCM] Firebase Messaging not supported in this browser"),console.error("[FCM] Try using Chrome, Firefox, or Edge")):o.code==="messaging/failed-service-worker-registration"?(console.error("[FCM] Service worker registration failed"),console.error("[FCM] Check that service-worker.js and firebase-messaging-sw.js are accessible")):o.code==="messaging/token-subscribe-failed"&&(console.error("[FCM] Failed to subscribe to FCM"),console.error("[FCM] Possible causes:"),console.error("[FCM]   - Network connectivity issue"),console.error("[FCM]   - Firebase project configuration problem"),console.error("[FCM]   - VAPID key mismatch")),console.error("[FCM] Full error object:",o),null}},g=o=>{const{title:i,body:e,icon:s=`${window.location.origin}/goodlift-logo.svg`,tag:r="goodlift-notification",requireInteraction:c=!1}=o;if(!("Notification"in window)){console.warn("Notifications not supported");return}if(Notification.permission==="granted")try{new Notification(i,{body:e,icon:s,tag:r,requireInteraction:c})}catch(l){console.error("Error showing notification:",l)}},f=(o,i=null)=>{let e=`ðŸ‹ðŸ»â€â™‚ï¸ Today's session: ${o}`;return i&&(e+=`
ðŸŒŸ Today's wellness task: ${i.task}`),{title:"Good Morning! â˜€ï¸",body:e}},F=async o=>{const{getTodaysWellnessTask:i}=await a(async()=>{const{getTodaysWellnessTask:r}=await import("./wellnessTaskService-CyWyGg8q.js");return{getTodaysWellnessTask:r}},[]),e=i(o.wellness||{}),s=f("Full Body Strength",e);g({title:s.title,body:s.body})};export{d as g,m as r,F as s};
