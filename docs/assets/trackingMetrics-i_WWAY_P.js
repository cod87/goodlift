const l=(p=[])=>{if(!p||p.length===0)return{currentStreak:0,longestStreak:0};const e=[...p].sort((n,d)=>new Date(d.date)-new Date(n.date)),o=[...new Set(e.map(n=>{const d=new Date(n.date);return`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`}))],t=new Date;t.setHours(0,0,0,0);let s=0,i=0,a=0,r=new Date(t);for(let n=0;n<90;n++){const d=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`;if(o.includes(d)){if(a++,s===0){const g=new Date(e[0].date);g.setHours(0,0,0,0),Math.floor((t-g)/(1e3*60*60*24))<=2&&(s=a)}i=Math.max(i,a)}else if(n>0&&a>0){const g=new Date(r);g.setDate(g.getDate()-1);const u=`${g.getFullYear()}-${String(g.getMonth()+1).padStart(2,"0")}-${String(g.getDate()).padStart(2,"0")}`;if(!o.includes(u)){if(s===0)break;a=0}}r.setDate(r.getDate()-1)}return{currentStreak:s,longestStreak:i}},f=(p=[])=>{const e={};return p.forEach(o=>{o.exercises&&Object.entries(o.exercises).forEach(([t,s])=>{!s.sets||s.sets.length===0||s.sets.forEach(i=>{const a=i.weight||0,r=i.reps||0;if(a===0&&r===0)return;const n=a>0&&r>0?a*(1+r/30):0;(!e[t]||a>(e[t].maxWeight||0))&&(e[t]||(e[t]={}),a>(e[t].maxWeight||0)&&(e[t].maxWeight=a,e[t].maxWeightDate=o.date,e[t].maxWeightReps=r)),(!e[t]||r>(e[t].maxReps||0))&&(e[t]||(e[t]={}),r>(e[t].maxReps||0)&&(e[t].maxReps=r,e[t].maxRepsDate=o.date,e[t].maxRepsWeight=a)),(!e[t]||n>(e[t].estimatedOneRepMax||0))&&(e[t]||(e[t]={}),n>(e[t].estimatedOneRepMax||0)&&(e[t].estimatedOneRepMax=Math.round(n*10)/10,e[t].oneRepMaxDate=o.date))})})}),e},h=(p,e={})=>{const o=[];if(!p||!p.exercises)return o;Object.entries(p.exercises).forEach(([s,i])=>{if(!i.sets||i.sets.length===0)return;const a=e[s]||{};i.sets.forEach(r=>{const n=r.weight||0,d=r.reps||0;if(n===0&&d===0)return;n>0&&n>(a.maxWeight||0)&&o.push({exerciseName:s,type:"weight",value:n,previousValue:a.maxWeight||0,reps:d}),d>0&&d>(a.maxReps||0)&&o.push({exerciseName:s,type:"reps",value:d,previousValue:a.maxReps||0,weight:n});const g=n>0&&d>0?n*(1+d/30):0;g>(a.estimatedOneRepMax||0)&&o.push({exerciseName:s,type:"oneRepMax",value:Math.round(g*10)/10,previousValue:a.estimatedOneRepMax||0})})});const t={};return o.forEach(s=>{const i=`${s.exerciseName}-${s.type}`;(!t[i]||s.value>t[i].value)&&(t[i]=s)}),Object.values(t)},c=p=>[{days:7,badge:"ðŸ”¥ Week Warrior",description:"7 day streak!"},{days:30,badge:"ðŸ’ª Monthly Master",description:"30 day streak!"},{days:90,badge:"ðŸ† Quarter Champion",description:"90 day streak!"},{days:180,badge:"ðŸ‘‘ Half Year Hero",description:"180 day streak!"},{days:365,badge:"â­ Year Legend",description:"365 day streak!"}].filter(o=>p>=o.days);export{l as calculateStreak,h as detectNewPRs,f as getPersonalRecords,c as getStreakMilestones};
