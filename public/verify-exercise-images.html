<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Exercise Image System Verification</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
      background: #f5f5f5;
    }
    h1, h2 {
      color: #333;
    }
    .intro {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .intro p {
      margin: 10px 0;
      color: #666;
    }
    .status {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 4px;
      font-weight: 600;
      font-size: 14px;
    }
    .status.pass {
      background: #4caf50;
      color: white;
    }
    .status.fail {
      background: #f44336;
      color: white;
    }
    .section {
      margin-bottom: 30px;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }
    .stat-box {
      padding: 20px;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #4caf50;
    }
    .stat-value {
      font-size: 32px;
      font-weight: bold;
      color: #333;
    }
    .stat-label {
      font-size: 14px;
      color: #666;
      margin-top: 5px;
    }
    .exercise-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .exercise-card {
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      padding: 15px;
      background: white;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .exercise-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .exercise-image {
      width: 100%;
      height: 180px;
      object-fit: contain;
      background: #fafafa;
      border-radius: 6px;
      margin-bottom: 12px;
    }
    .exercise-image.error {
      border: 2px dashed #f44336;
      background: #ffebee;
    }
    .exercise-name {
      font-weight: 600;
      font-size: 15px;
      margin-bottom: 6px;
      color: #1976d2;
      line-height: 1.3;
    }
    .exercise-muscle {
      font-size: 13px;
      color: #666;
      margin-bottom: 8px;
    }
    .badges {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }
    .badge {
      display: inline-block;
      padding: 3px 10px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 600;
    }
    .badge-webp {
      background: #4caf50;
      color: white;
    }
    .badge-svg {
      background: #2196f3;
      color: white;
    }
    .badge-error {
      background: #f44336;
      color: white;
    }
    .image-path {
      font-size: 11px;
      color: #999;
      margin-top: 6px;
      font-family: monospace;
      word-break: break-all;
    }
    .filter-buttons {
      display: flex;
      gap: 10px;
      margin: 15px 0;
    }
    .filter-btn {
      padding: 8px 16px;
      border: 2px solid #1976d2;
      background: white;
      color: #1976d2;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s;
    }
    .filter-btn:hover {
      background: #1976d2;
      color: white;
    }
    .filter-btn.active {
      background: #1976d2;
      color: white;
    }
  </style>
</head>
<body>
  <div class="intro">
    <h1>Exercise Image System Verification</h1>
    <p>This page verifies that exercise images are correctly loaded and displayed from the new image system.</p>
    <p>System status: <span class="status pass" id="system-status">Loading...</span></p>
  </div>

  <div class="section">
    <h2>Statistics</h2>
    <div class="stats">
      <div class="stat-box" style="border-left-color: #2196f3;">
        <div class="stat-value" id="total-count">-</div>
        <div class="stat-label">Total Exercises</div>
      </div>
      <div class="stat-box" style="border-left-color: #4caf50;">
        <div class="stat-value" id="webp-count">-</div>
        <div class="stat-label">Demo Photos (webp)</div>
      </div>
      <div class="stat-box" style="border-left-color: #9c27b0;">
        <div class="stat-value" id="svg-count">-</div>
        <div class="stat-label">Muscle Diagrams (svg)</div>
      </div>
      <div class="stat-box" style="border-left-color: #ff9800;">
        <div class="stat-value" id="coverage">-</div>
        <div class="stat-label">Image Coverage</div>
      </div>
    </div>
  </div>

  <div class="section">
    <h2>Exercise Display Test</h2>
    <div class="filter-buttons">
      <button class="filter-btn active" onclick="filterExercises('all')">All</button>
      <button class="filter-btn" onclick="filterExercises('webp')">Demo Photos</button>
      <button class="filter-btn" onclick="filterExercises('svg')">Muscle Diagrams</button>
    </div>
    <div class="exercise-grid" id="exercise-grid"></div>
  </div>

  <script type="module">
    const BASE_URL = window.location.pathname.includes('/goodlift/') ? '/goodlift/' : '/';
    
    let allExercises = [];
    let currentFilter = 'all';

    // Fetch exercises.json
    try {
      const response = await fetch(`${BASE_URL}data/exercises.json`);
      const exercises = await response.json();
      allExercises = exercises;
      
      // Update statistics
      const withWebp = exercises.filter(e => e.image?.startsWith('demos/'));
      const withSvg = exercises.filter(e => e.image?.startsWith('svg-muscles/'));
      const withImage = exercises.filter(e => e.image);
      
      document.getElementById('total-count').textContent = exercises.length;
      document.getElementById('webp-count').textContent = withWebp.length;
      document.getElementById('svg-count').textContent = withSvg.length;
      document.getElementById('coverage').textContent = `${((withImage.length / exercises.length) * 100).toFixed(1)}%`;
      
      // Update system status
      const allHaveImages = exercises.every(e => e.image);
      const statusEl = document.getElementById('system-status');
      if (allHaveImages) {
        statusEl.textContent = '✓ All exercises have images';
        statusEl.className = 'status pass';
      } else {
        statusEl.textContent = '✗ Some exercises missing images';
        statusEl.className = 'status fail';
      }
      
      // Render exercises
      renderExercises(exercises.slice(0, 24)); // Show first 24
      
    } catch (error) {
      console.error('Failed to load exercises:', error);
      document.getElementById('system-status').textContent = '✗ Failed to load data';
      document.getElementById('system-status').className = 'status fail';
    }

    function renderExercises(exercises) {
      const container = document.getElementById('exercise-grid');
      container.innerHTML = '';
      
      exercises.forEach(exercise => {
        const card = createExerciseCard(exercise);
        container.appendChild(card);
      });
    }

    function createExerciseCard(exercise) {
      const card = document.createElement('div');
      card.className = 'exercise-card';
      card.dataset.type = exercise.image?.startsWith('demos/') ? 'webp' : 'svg';
      
      const img = document.createElement('img');
      img.className = 'exercise-image';
      img.alt = exercise['Exercise Name'];
      
      if (exercise.image) {
        img.src = `${BASE_URL}${exercise.image}`;
        img.onerror = () => {
          img.classList.add('error');
          img.alt = 'Image failed to load';
        };
      } else {
        img.src = `${BASE_URL}work-icon.svg`;
        img.style.opacity = '0.3';
      }
      
      const name = document.createElement('div');
      name.className = 'exercise-name';
      name.textContent = exercise['Exercise Name'];
      
      const muscle = document.createElement('div');
      muscle.className = 'exercise-muscle';
      muscle.textContent = `${exercise['Primary Muscle']} • ${exercise['Equipment']}`;
      
      const badges = document.createElement('div');
      badges.className = 'badges';
      
      if (exercise.image) {
        const badge = document.createElement('div');
        badge.className = exercise.image.startsWith('demos/') ? 'badge badge-webp' : 'badge badge-svg';
        badge.textContent = exercise.image.startsWith('demos/') ? 'WEBP' : 'SVG';
        badges.appendChild(badge);
      } else {
        const badge = document.createElement('div');
        badge.className = 'badge badge-error';
        badge.textContent = 'NO IMAGE';
        badges.appendChild(badge);
      }
      
      const path = document.createElement('div');
      path.className = 'image-path';
      path.textContent = exercise.image || 'No image path';
      
      card.appendChild(img);
      card.appendChild(name);
      card.appendChild(muscle);
      card.appendChild(badges);
      card.appendChild(path);
      
      return card;
    }

    window.filterExercises = function(type) {
      currentFilter = type;
      
      // Update button states
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');
      
      // Filter exercises
      let filtered = allExercises;
      if (type === 'webp') {
        filtered = allExercises.filter(e => e.image?.startsWith('demos/'));
      } else if (type === 'svg') {
        filtered = allExercises.filter(e => e.image?.startsWith('svg-muscles/'));
      }
      
      renderExercises(filtered.slice(0, 24));
    };
  </script>
</body>
</html>
